---
layout: single
title:  "[PM]ë¨¸ë‹ˆë­ë‹ˆ í™œë™ì¼ì§€: 3ì£¼ì°¨"
categories: ë¨¸ë‹ˆë­ë‹ˆ
tag: [ë¨¸ë‹ˆë­ë‹ˆ, iOS, PM, WHATISMONEY]
toc: true
author_profile: false
sidebar:
  nav: "docs"
search: true
---

# ğŸ¤›ğŸ»Â [3ì£¼ì°¨]

1ì›” 18ì¼ ì €ë… 10ì‹œ ì­ì­ì´ íƒˆì£¼í–ˆë‹¤.

ì •í™•í•œ ì´ìœ ë„ ë“£ì§€ ëª»í•œ ì±„(ë‘ë£¨ë­‰ìˆ í•˜ê²Œ ë°±ì—”ë“œ ë¶„ì•¼ë¥¼ ë°°ìš¸ ê¸°íšŒê°€ ì™”ë‹¤ê³  í–ˆë‹¤) ì­ì­ì´ ë§Œë“  ê·¸ë™ì•ˆì˜ ì‘ì—…ë¬¼ë„ ì „ë¶€ ë¦¬ì…‹ëœ í›„ì˜€ë‹¤.

ë‚´ ë°ìŠ¤ë…¸íŠ¸ì— ì´ë¦„ì´ ì•„ì§ê¹Œì§€ ì í˜€ìˆë‹¤.

ì‚¬ì‹¤ ì´ë ‡ê²Œ íƒˆì£¼ ì˜ì‚¬ë¥¼ ë³´ì´ëŠ” íŒ€ì›ë“¤ì„ ì˜ ì¡°ìœ¨í•˜ëŠ” ê²ƒë„ PMì˜ ì—­ëŸ‰ì´ë¼ê³  ìƒê°í•œë‹¤.

í•˜ì§€ë§Œ ë‚œ ì˜ì§€ë„ ì±…ì„ê°ë„ ê°–ì§€ ì•Šì€ íŒ€ì›ì„ ëê¹Œì§€ ëŒê³  ê°ˆ ê·¸ ì—ë„ˆì§€ë¥¼ ë‹¤ë¥¸ íŒ€ì›ë“¤ì—ê²Œ ë” ë‚˜ëˆ„ì–´ ì£¼ê³  ì‹¶ì—ˆê¸°ì—, ê·¸ì € ë¶™ì¡ì§€ ì•Šê³  ê³¼ê°í•˜ê²Œ ê²°ë‹¨ì„ ë‚´ë ¸ë‹¤. 

ë•ë¶„ì— ì­ì­ì— ë‚˜ì—ê²Œ ì „í™”ë¥¼ ê±´ ê·¸ ìƒˆë²½, ë°¤ì„ ìƒˆì„œ ì­ì­ì´ ë‚ ë ¤ë¨¹ì€ í™”ë©´ì„ ì²˜ìŒë¶€í„° ì œì‘í–ˆë‹¤.

ê·¸ë‚˜ë§ˆ ë‹¤í–‰ì¸ ì ì€, ë‚´ ë°©ì‹ëŒ€ë¡œ í™”ë©´ì„ êµ¬ì„±í•´ì„œ [ëª©í‘œ] í™”ë©´ì´ ë” ê¹”ë”í•´ì¡Œê³  ì´ì œì•¼ ì „ì²´ í™”ë©´ë“¤ì„ ì—°ê²°í•  ìˆ˜ ìˆì—ˆë‹¤ëŠ” ì ì´ì—ˆë‹¤.

<img width="358" alt="3-1" src="https://user-images.githubusercontent.com/102133961/218255273-38eab5ad-5d42-4a9e-8357-ce0e8c0aef57.png">

ì•„, ì¤‘ê°„ì— ë¬¼ë¡  ë¬¸ì œê°€ ìƒê¸°ê¸´ í–ˆë‹¤.

ë¬´ìŠ¨ì¼ì¸ì§€ tab bar controllerì— ì—°ê²°í•œ ë·° ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ navigation itemì´ ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí•œ ê²ƒì´ë‹¤(navigation controllerëŠ” í™”ë©´ ì œì¼ ì•ì— ìœ„ì¹˜í•˜ê³  ìˆì—ˆë‹¤)

ì´ë•Œ ì²œì¬ í”¼ì¹˜ê°€ í•´ê²°ì±…ì„ ë‚´ë†“ì•˜ëŠ”ë°, view controllerë¥¼ ê·¸ í™”ë©´ ë°”ë¡œ ì•ì— ì§‘ì–´ë„£ì–´ í•´ê²°í–ˆë‹¤.

(ì•„ë§ˆë„ ê¸°ì¡´ navigation controllerì™€ í™”ë©´ ìƒì˜ ê°„ê²©ì´ ë„ˆë¬´ ë²Œì–´ì ¸ì„œ ê·¸ëŸ° ë¬¸ì œê°€ ìƒê¸´ ê²ƒì´ ì•„ë‹ê¹Œ ìƒê°í•œë‹¤.)

ì´ê±¸ git organizationì˜ ìƒˆë¡œìš´ ë¸Œëœì¹˜ì¸ stagingì— push í–ˆëŠ”ë°(í”¼ì¹˜ê°€)

ì´ê±¸ ê¸°ì¡´ì˜ forkí•œ ë‚´ ë ˆí¬ì— ì–´ë–»ê²Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ì§€ ëª°ëë‹¤(ë‚´ ë ˆí¬ì—ëŠ” main ë¸Œëœì¹˜ ë°–ì— ì—†ìœ¼ë‹ˆê¹Œâ€¦)

ê·¸ë˜ì„œ ìƒˆë¡œ ë°°ìš´ 

## re-fork í•˜ëŠ” ë°©ë²•

```swift
git remote add upstream [ê¸°ì¡´ ë ˆí¬ url]
// ì˜¤ë¦¬ì§€ë„ ë ˆí¬ë¥¼ upstreamìœ¼ë¡œ ì¶”ê°€

git remote -v
// ì˜ ë˜ì—ˆëŠ”ì§€ í™•ì¸

git fetch [ì‹ ê·œ ë¸Œëœì¹˜ ì´ë¦„]
// ìƒˆë¡œìš´ ë¸Œëœì¹˜ë“¤ì„ ì´ëŸ° ì‹ìœ¼ë¡œ ê°€ì ¸ì˜´

git checkout staging

git push origin staging
// ë‚´ ë ˆí¬ì—ë„ ë°˜ì˜
```

 

ë‹¤ë§Œ ì´ë ‡ê²Œ í–ˆë”ë‹ˆ, ê¸°ì¡´ Local íŒŒì¼ì˜ mainì´ ì‘ë™í•˜ì§€ ì•Šê³ 

line 604: starttag: invalid element name

ì´ëŸ° ìš”ìƒí•œ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤

êµ¬ê¸€ë§ì„ í†µí•´ xml íŒŒì¼ì— ë¬¸ì œê°€ ìƒê¸´ ê±´ ì•Œê² ì§€ë§Œ, ì •í™•í•œ ë¬¸ì œ í•´ê²° ë°©ì‹ì„ ëª°ë¼ì„œ

ê·¸ëƒ¥ ë¡œì»¬ì—ì„œ ìƒˆë¡œ cloneì„ ë°›ì•„ì™”ë”ë‹ˆ ì œëŒ€ë¡œ ë™ì‘í•˜ê¸° ì‹œì‘í–ˆë‹¤.

### [swift ì„œë²„ í†µì‹ ]

ë‹¤ìŒì£¼ ì¦ˆìŒì— ì„œë²„íŒ€ì´ APIë¥¼ ì™„ì„±í•˜ê¸°ë¡œ í•´ì„œ ìŠ¬ìŠ¬ ios ì„œë²„ í†µì‹  ë°©ë²•ì„ ì •ë¦¬í•´ ë³´ë ¤ê³  í•œë‹¤.

ì‚¬ì‹¤ ì˜¤ëŠ˜(1ì›” 19ì¼ ëª©) iOS íšŒì˜ì—ì„œ í†µì‹  ë°©ë²•ì„ ì •ë¦¬í•˜ê¸°ë¡œ í•´ì„œ ë¯¸ë¦¬ ì•Œì•„ë³´ëŠ” ê²ƒì´ë‹¤.

openAPI ì£¼ì†Œì— POSTë¡œ ë°ì´í„°ë¥¼ ë„˜ê²¨ì•¼ í•˜ëŠ” ìƒí™©.

HTTP BODYë¡œ ë‹¤ìŒì˜ ë°ì´í„°ë¥¼ ë„˜ê²¨ì•¼ í•œë‹¤ê³  í•˜ì

```swift
{
id: "dbswlsdyd",
name: "ìœ¤ì§„ìš©",
email: "dbswlsdyd730@naver.com",
userID:"ì§„ìš©01",
password: "1234",
agree: TRUE
}
```

ì´ë¥¼ ìœ„í•´ì„œ doby ì¸ì í˜•íƒœì— ë§ëŠ” codable structë¥¼ ë§Œë“¤ì–´ì£¼ì–´ì•¼ í•œë‹¤.

```swift
import Foundation

struct PostComment: Codable {
    let id: String
    let name: String
    let email: String
    let userID: String
    let password: String
    let agree: Boolean

    enum CodingKeys: String, Boolean, CodingKey {
        case id, name, email, password
        case agree
        case userID = "userID"
    }
}
```

structë¥¼ ì „ë¶€ ë§Œë“¤ì—ˆë‹¤ë©´, post ìˆ˜í–‰ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤

post ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œì—” ë¨¼ì € post í•  body ë¶€ë¶„ì„ ë¨¼ì € ì‘ì„±í•˜ê³ , 

ê·¸ bodyë¥¼ JSONEncoder()ë¡œ encode ì‹œí‚¨ ë’¤

URLSession.uploadTask(with: request, from: encodedBody)ë¡œ ì¥ì‹í•œë‹¤

```swift
func postComment(id: String, name: String, email: String, userID: String, password: String, agree: Boolean) {

    // ë„£ëŠ” ìˆœì„œë„ ìˆœì„œëŒ€ë¡œì—¬ì•¼ í•˜ëŠ” ê²ƒ ê°™ë‹¤.
    let comment = PostComment(id: String, name: String, email: String, userID: String, password: String, agree: Boolean)
    guard let uploadData = try? JSONEncoder().encode(comment)
    else {return}

    // URL ê°ì²´ ì •ì˜
    let url = URL(string: "https://www.notion.so/8ab9ec8ec27148c9ba1801979f75fdce")

    // URLRequest ê°ì²´ë¥¼ ì •ì˜
    var request = URLRequest(url: url!)
    request.httpMethod = "POST"
    // HTTP ë©”ì‹œì§€ í—¤ë”
    request.setValue("application/json", forHTTPHeaderField: "Content-Type")

    // URLSession ê°ì²´ë¥¼ í†µí•´ ì „ì†¡, ì‘ë‹µê°’ ì²˜ë¦¬
    let task = URLSession.shared.uploadTask(with: request, from: uploadData) { (data, response, error) in

        // ì„œë²„ê°€ ì‘ë‹µì´ ì—†ê±°ë‚˜ í†µì‹ ì´ ì‹¤íŒ¨
        if let e = error {
            NSLog("An error has occured: \(e.localizedDescription)")
            return
        }
        // ì‘ë‹µ ì²˜ë¦¬ ë¡œì§
        print("comment post success")
    }
    // POST ì „ì†¡
    task.resume()
}
```

ê° ëª…ì„¸ì„œì— ë§ëŠ” HTTP ë©”ì†Œë“œ ë°©ì‹ìœ¼ë¡œ request í•´ì•¼ í•˜ëŠ”ë°

<img width="1023" alt="3-2" src="https://user-images.githubusercontent.com/102133961/218255322-16cbeeef-374b-43b3-8f33-877f27e875e8.png">

Patchì™€ Deleteë¥¼ ì–´ë–»ê²Œ ì‘ì„±í•  ì§€ ë²Œì¨ë¶€í„° ë‘ë µë‹¤ ã„·ã„·ã„·

ê·¸ë¦¬ê³  ìš°ë¦¬ëŠ” ë¡œê·¸ì¸ ë°©ì‹ì„ X_ACCESS_TOKENì„ ì´ìš©í•˜ê¸°ë¡œ í•´ì„œ

í—¤ë”ì— ì–´ë–»ê²Œ ì¶”ê°€í•´ì•¼ í• ì§€ ëª°ë¼, í•œì°¸ì„ í—¤ë§¤ì—ˆëŠ”ë°(ë„ì™€ì£¼ì„¸ìš” êµ¬ê¸€ êµìˆ˜ë‹˜)

```swift
import Cocoa

let session: URLSession = URLSession.shared
func session_check(url: URL, accessToken: String, completionHandler: @escaping (Data?, URLResponse?, Error?) -> Void) throws {
    var request: URLRequest = URLRequest(url: url)
    request.httpMethod = "GET"
    request.addValue("application/x-www-form-urlencoded", forHTTPHeaderField: "Content-Type")
    request.addValue("Bearer " + accessToken, forHTTPHeaderField: "Authorization")
    request.addValue("Mozilla/5.0", forHTTPHeaderField: "User-Agent")
        session.dataTask(with: request, completionHandler: completionHandler).resume()
}

let accessToken: String = "xxxx-yyyy-zzzz"
let url: URL = URL(string: "http://192.168.0.26:8080/et")!
do {
    try session_check(url: url, accessToken: accessToken, completionHandler: { data, response, error in
        if let httpResponse = response as? HTTPURLResponse {
            let returnCode = httpResponse.statusCode
            if returnCode == 200 {    print("200 OK")    }
        }
    })
} catch {
    print(error)
}
sleep(1)
```

ë§ˆì¹¨ë‚´ êµ¬ê¸€ êµìˆ˜ë‹˜ê»˜ì„œ í•œ ì˜ˆì œë¥¼ ë³´ì—¬ì£¼ì‹œë©° ì˜ë¬¸ì„ í•´ì†Œí•´ì£¼ì…¨ë‹¤.

í—¤ë”ì—ë‹¤ addValueë¡œ accessTokenì„ ì¶”ê°€í•´ì£¼ë©´ ë˜ëŠ”êµ¬ë‚˜â€¦ì´ë ‡ê²Œ í•˜ëŠ”ê±°êµ¬ë§Œâ€¦

ê²°êµ­ GET POST PATCH DELETE ë©”ì†Œë“œë“¤ì„ ì§ì ‘ ì ì–´ë³´ë©°

ì„œë²„ í†µì‹ ì˜ ê³ ì˜¤ìˆ˜ê°€ ë˜ì–´ë²„ë ¸ë‹¤.

ì´ë²ˆ ë°©í•™ ë•Œ Spring ê³µë¶€ê°€ ì¤‘ì ì´ì—ˆë˜ ê²ƒ ê°™ì€ë°, ì–´ëŠìƒŒê°€ IOS ê³µë¶€ë¥¼ ë” ë§ì´ í•˜ê³  ìˆëŠ” ê²ƒ ê°™ë‹¤.

ì—­ì‹œ í° í”„ë¡œì íŠ¸ëŠ” ì‚¬ëŒì„ ì–µì§€ë¡œ ì„±ì¥ì‹œí‚¤ëŠ” ê²ƒ ê°™ë‹¤.

```swift
func postGoal() {
        
        // ë„£ëŠ” ìˆœì„œë„ ìˆœì„œëŒ€ë¡œì—¬ì•¼ í•˜ëŠ” ê²ƒ ê°™ë‹¤.
        let goal = Goal(goal_amount: Int(GoalPriceTextField.text ?? "0")!, init_amount: Int(InitPriceTextField.text ?? "0")!, category_name: GoalTextField.text ?? "ë””í´íŠ¸ ê³¨", date: Date().toString())
        
        //print(goal)
        /*Goal(userIdx: 1, init_amount: Int(InitPriceTextField.text ?? "0")!, goal_amount: Int(GoalPriceTextField.text ?? "0")!, GoalName: GoalTextField.text ?? "ë””í´íŠ¸ ê³¨", GoalImage: imagebase64 ?? "ë””í´íŠ¸ì´ë¯¸ì§€")*/
        guard let uploadData = try? JSONEncoder().encode(goal)
        else {return}
        
        // URL ê°ì²´ ì •ì˜
        let userIdx = UserDefaults.standard.integer(forKey: "userIdx")
        let url = URL(string: "https://www.pigmoney.xyz/goal/createGoal/\(userIdx)")
        
        // URLRequest ê°ì²´ë¥¼ ì •ì˜
        var request = URLRequest(url: url!)
        request.httpMethod = "POST"
        // HTTP ë©”ì‹œì§€ í—¤ë”
        request.setValue("application/json", forHTTPHeaderField: "Content-Type")
        request.addValue(UserDefaults.standard.string(forKey: "accessToken") ?? "0", forHTTPHeaderField: "X-ACCESS-TOKEN")
        
        request.httpBody = uploadData
        //print(String(data: uploadData, encoding: .utf8)!)
        
        // URLSession ê°ì²´ë¥¼ í†µí•´ ì „ì†¡, ì‘ë‹µê°’ ì²˜ë¦¬
        let task = URLSession.shared.uploadTask(with: request, from: uploadData) { (data, response, error) in
            
            // ì„œë²„ê°€ ì‘ë‹µì´ ì—†ê±°ë‚˜ í†µì‹ ì´ ì‹¤íŒ¨
            if let e = error {
                NSLog("An error has occured: \(e.localizedDescription)")
                return
            }
            // ì‘ë‹µ ì²˜ë¦¬ ë¡œì§
            guard let data = data else { return }
            
            // data
            let decoder = JSONDecoder()
            if let json = try? decoder.decode(responseP.self, from: data) {
                print(json.message)
            }
        }
            // POST ì „ì†¡
            task.resume()
        
    }

func patchGoal() {
            // ë„£ëŠ” ìˆœì„œë„ ìˆœì„œëŒ€ë¡œì—¬ì•¼ í•˜ëŠ” ê²ƒ ê°™ë‹¤.
            /*print("\n\n\n\n\n\n")
            print("ì—¬ê¸° ê¼­ í™•ì¸í•´ë¼ ì¢‹ì€ ë§ í•  ë•Œ")
            print(oldImage == self.convertImageToBase64(image: ImgUI.currentImage!))
            print(convertImageToBase64(image: ImgUI.currentImage!))
            print(GoalPriceTextField.text as Any)
            print(PriceTextField.text as Any)
            print(GoalNameTextField.text as Any)
            print("í™•ì¸ ë")
            print("\n\n\n\n\n\n")*/
            
            
            let patchgoal = patchgoal(amount: Int(PriceTextField.text ?? "5") ?? 5, category_name: GoalNameTextField.text ?? "ì•Œ ìˆ˜ ì—†ìŒ", image: convertImageToBase64(image: ImgUI.currentImage!), init_amount: Int(GoalPriceTextField.text ?? "5") ?? 5)
            /*let patchgoal = patchgoal(image: convertImageToBase64(image: ImgUI.currentImage!), goal_amount: Int(GoalPriceTextField.text ?? "5") ?? 5, init_amount: Int(InitPriceTextField.text ?? "5") ?? 5, category_name: GoalNameTextField.text ?? "ì•Œ ìˆ˜ ì—†ìŒ")*/
            
            print("\n\n\n\n\n")
            print("=================")
            print("ì—¬ê¸°ë„ í™•ì¸")
            print(oldImage == self.convertImageToBase64(image: ImgUI.currentImage!))
            print(patchgoal)
            print("=================")
            print("\n\n\n\n\n")
                                      
            guard let uploadData = try? JSONEncoder().encode(patchgoal) else {return}
            
            /*print("\n\n\n\n\n")
            print("=================")
            print("ì—…ë¡œë“œ ë°ì´í„°")
            print(uploadData.self)
            print("=================")
            print("\n\n\n\n\n")*/
            
            
            // URL ê°ì²´ ì •ì˜
            let userIdx = UserDefaults.standard.integer(forKey: "userIdx")
            let url = URL(string: "https://www.pigmoney.xyz/goal/modifyGoal/\(goalIdx!)/\(userIdx)")

            
            // URLRequest ê°ì²´ë¥¼ ì •ì˜
            var request = URLRequest(url: url!)
            request.httpMethod = "PATCH"
            // HTTP ë©”ì‹œì§€ í—¤ë”
            request.setValue("application/json", forHTTPHeaderField: "Content-Type")
            request.setValue( UserDefaults.standard.string(forKey: "accessToken") ?? "0", forHTTPHeaderField: "X-ACCESS-TOKEN")
            
            request.httpBody = uploadData
          /*  print("###############ì—…ë¡œë“œ ë°ì´í„°ë‹¤###################")
            print(String(data: uploadData, encoding: .utf8)!)*/
    
                    // URLSession ê°ì²´ë¥¼ í†µí•´ ì „ì†¡, ì‘ë‹µê°’ ì²˜ë¦¬
                    URLSession.shared.uploadTask(with: request, from: uploadData) { (data, response, error) in
                        
                        guard let data = data else {
                            print("Error: Did not receive data")
                            return
                        }
                        
                        /*print("**************ì‘ë‹µë°ì´í„°*****************")
                        print(String(data: data, encoding: .utf8)!)
                        print("**************ì‘ë‹µë°ì´í„°*****************")*/
                        
                        guard let response = response as? HTTPURLResponse, (200 ..< 299) ~= response.statusCode else {
                            print("Error: HTTP request failed")
                            return
                        }
                        
                        let decoder = JSONDecoder()
                        if let json = try? decoder.decode(goalpatchresponse.self, from: data) {
                            print(json.message)
                            
                        }
                        // POST ì „ì†¡
                    }.resume()
               
        }

func loadcategory(){
        let userIdx = UserDefaults.standard.integer(forKey: "userIdx")
        if let url = URL(string: "https://www.pigmoney.xyz/category/\(userIdx)/\(flag!)"){
            
            var request = URLRequest.init(url: url)
            
            request.httpMethod = "GET"
            
            request.setValue("application/json", forHTTPHeaderField: "Content-Type")
            request.addValue( UserDefaults.standard.string(forKey: "accessToken") ?? "0", forHTTPHeaderField: "X-ACCESS-TOKEN")
            
            DispatchQueue.global().async {
                do {
                    
                    URLSession.shared.dataTask(with: request){ [self] (data, response, error) in
                        
                        guard let data = data else {
                                                  print("Error: Did not receive data")
                                                  return
                                              }
                                              
                                             // print(String(data: data, encoding: .utf8)!)
                                              
                                              
                                              
                                              guard let response = response as? HTTPURLResponse, (200 ..< 299) ~= response.statusCode else {
                                                  print("Error: HTTP request failed")
                                                  return
                                              }

                        
                        let decoder = JSONDecoder()
                        if let json = try? decoder.decode(categoryresult.self, from: data) {
                            self.resultlist =  json.result
                            observeresultlist()
                        }
                        
                    }.resume() //URLSession - end
                    
                }
            }
            
        }
        
    }  //ë” ìˆì§€ë§Œ...ì´ë§Œ ìƒëµ
```


